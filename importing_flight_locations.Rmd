---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(sf)
library(lubridate)
library(move)
library(here)
```

```{r}
amwo_data <- getMovebankData(study = "American Woodcock Migration Ecology in Eastern North America", 
                             login = readRDS("movebank_credentials.rds"), 
                             removeDuplicatedTimestamps=TRUE)
amwo_data <- as.data.frame(amwo_data)

amwo_data %>%
  transmute(ID = local_identifier,
            time = as.character(timestamp),
            lon = location_long, 
            lat = location_lat,
            event_id = event_id,
            tagtype = comments,
            sex = sex,
            age = taxon_detail,
            height_above_wgs84 = height_above_msl,
            fix = location_error_text,
            point_state = behavioural_classification) ->
  amwo_data
```

```{r}
amwo_data %>%
  filter((!is.na(height_above_wgs84)) & (!is.na(point_state))) %>%
  write.csv(here("intermediate_files", "imported_movebank_data.csv"))

# Vertical datum is WKID::115700
```

